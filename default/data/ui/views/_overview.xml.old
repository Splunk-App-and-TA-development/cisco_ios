<?xml version='1.0' encoding='utf-8'?>
<dashboard>
  <label>Overview</label>
  <row>
    <chart>
      <searchString>sourcetype=cisco:ios | top mnemonic | rename count AS Amount</searchString>
      <title>Top messages</title>
      <option name="charting.axisTitleX.text">Message</option>
      <option name="charting.chart">bar</option>
      <option name="charting.primaryAxisTitle.text"/>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </chart>
    <chart>
      <searchString>sourcetype=cisco:ios | rare mnemonic | rename count AS Amount</searchString>
      <title>Rare messages</title>
      <option name="charting.axisTitleX.text">Message</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">bar</option>
      <option name="charting.primaryAxisTitle.text"/>
      <option name="charting.secondaryAxis.scale">linear</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </chart>
  </row>
  <row>
    <table>
      <searchName>port flapping</searchName>
      <title>Port flapping</title>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </table>
    <table>
      <searchString>sourcetype=cisco:ios eventtype="cisco_ios-err_disable" | stats count(detected_on_interface) AS Amount BY host,detected_on_interface,disable_interface,disable_cause | rename detected_on_interface AS Interface, disable_interface AS "Dis. Interface", disable_cause AS Cause</searchString>
      <title>Error disabled interfaces</title>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </table>
    <chart>
      <searchString>sourcetype=cisco:ios | chart count(severity) by severity_name</searchString>
      <title>Syslog severity distribution</title>
      <option name="charting.chart">pie</option>
      <option name="charting.chart.sliceCollapsingThreshold">0</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </chart>
  </row>
  <row>
    <table>
      <!--<searchString>eventtype="cisco_ios-acl_log" | top limit=10 acl_proto,acl_list,acl_action,acl_src_ip,acl_dst_port by host | table host,acl_proto,acl_list,acl_action,acl_src_ip,acl_dst_port,host,count | sort 10 - count by host</searchString>-->
      <searchString>eventtype="cisco_ios-acl_log" NOT [inputlookup cisco_ios_acl_excluded_ips | fields acl_src_ip] | top limit=10 acl_proto,acl_list,acl_action,acl_src_ip,acl_dst_port by host | table host,acl_proto,acl_list,acl_action,acl_src_ip,acl_dst_port,host,count | sort 10 - count by host</searchString>
      <title>Top ACL logs by host (excluding hits from local management IPs)</title>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </table>
  </row>
</dashboard>
